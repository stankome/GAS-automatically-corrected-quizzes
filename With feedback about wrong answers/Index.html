<html>
  <head>
    <base target="_top" />
  </head>
  <body>
 <p>1.	The excel sheet <a href=" http://www.ipt.ntnu.no/~stanko/files/Courses/TPG4230/2022/Quizzes/Quiz-14_Q1.xlsm"> provided </a> contains the steady-state pressure and temperature profile along the pipeline that goes from the Åsgard Subsea Compression Project (SCSt) to Asgard B (in the sheet “p_T_pipeline”). The sheet “Hydrate line” contains the p-T points of the hydrate line with no inhibitor and it allows to compute a new hydrate line when Mono ethylene glycol is added (using the Hammerschmidt equation). What is the minimum w% MEG is required to avoid the formation of hydrate on the pipe (insert the number without digits after the decimal point)</p>
<label for="Q1"> Answer: </label>
<input type="text" id="Q1" name="Q1">
<br>
 <p>2.	As a follow-up to question 1, assume that the free water comes only from condensation from the gas. Reservoir gas is saturated with water at a reservoir pressure and temperature of 276 bara and 92 C respectively.  <a href=" http://www.ipt.ntnu.no/~stanko/files/Courses/TPG4230/2022/Quizzes/Water_solubility.xls"> This </a> calculator gives how much water is dissolved in the gas at a given pressure and temperature, in kg of water/1E06 Sm3 of gas.  </p>
<p> Using the weight % found in Q1, how much MEG is necessary to inject to avoid hydrate formation in the pipeline, assuming that gas production is 10 E06 Sm3/d? Neglect the presence of condensate, assume the free liquid is made up of water and MEG only. Enter the number in kg/d without digits after the decimal point</p>
<label for="Q2"> Answer: </label>
<input type="text" id="Q2" name="Q2">
<br>
 <p>3.	As a follow-up to question 2, Asgard has facilities to reclaim and regenerate MEG, but the efficiency of the process is 98% (2% of the MEG evaporates and goes with the gas). Using the answer from question 2 and assuming a year with 360 operational days, a MEG density of 1150 kg/m3 and a cost of MEG of 10 NOK/liter, how much does MEG “make-up” represents annually in OPEX to Equinor? Enter the number in million NOK.</p>
<label for="Q3"> Answer: </label>
<input type="text" id="Q3" name="Q3">
<br>
 <p>4.	The salinity of the water affects the hydrate formation curve. A higher water salinity shifts the hydrate formation curve to the left (acts as a hydrate inhibitor). <a href=" http://www.ipt.ntnu.no/~stanko/files/Courses/TPG4230/2022/Quizzes/Hydrate_curves_with_salinity.xlsx"> This </a> file contains several hydrate formation curves for the same hydrocarbon fluid for water with varying salinity. </p>
 <p>Consider a subsea oil field. The reservoir has an aquifer with water salinity equal to 250 000 ppm. The field produces to a topside 50 km away through an uninsulated pipeline. The inlet pressure and temperature are 100 bar and 70 C. The outlet pressure and temperature are 50 bara and 10 C. </p>
<p>The field will produce aquifer water during its life. According to the hydrate formation curves provided earlier, is it necessary to inject MEG or to provide pipeline insulation?</p>
</p>
 <form>
  <input type="radio" id="Q4-1-1" name="Q4-1" value="Q4-1-1">
  <label for="Q4-1-1">Yes</label><br>
  <input type="radio" id="Q4-1-2" name="Q4-1" value="Q4-1-2">
  <label for="Q4-1-2">No</label><br>
  </form>
 <p>A proposal to increase recovery from this field is to perform seawater (salinity equal to 35 000 ppm) injection using the <a href=" https://www.nov.com/products/seabox-subsea-water-treatment-technology"> Seabox </a> technology from NOV. The problem is that, in time, the salinity of the produced water will decrease, when the injected seawater starts reaching the injectors. According to the hydrate formation curves provided earlier, would it be necessary to inject MEG or to provide pipeline insulation if seawater injection is employed? </p>
 <form>
  <input type="radio" id="Q4-2-1" name="Q4-2" value="Q4-2-1">
  <label for="Q4-2-1">Yes</label><br>
  <input type="radio" id="Q4-2-2" name="Q4-2" value="Q4-2-2">
  <label for="Q4-2-2">No</label><br>
  </form>
 <p>A colleague working on this project has indicated that the disadvantage of injecting seawater is that it could potentially generate carbonate scaling in the production wells, due to mixing of formation and seawater, is he correct?    </p>
 <form>
  <input type="radio" id="Q4-3-1" name="Q4-3" value="Q4-3-1">
  <label for="Q4-3-1">Yes</label><br>
  <input type="radio" id="Q4-3-2" name="Q4-3" value="Q4-3-2">
  <label for="Q4-3-2">No</label><br>
  </form>
   <p>To address hydrate problems in the seawater injection case, a colleague working on this project has suggested to increase separator pressure to 120 bara, and having a subsea pump at the inlet of the flowline, such that the fluid in the pipe remains in single phase oil during transportation, there will be no gas liberation and therefore, hydrate formation will no longer be a concern. Do you agree with this statement?   </p>
 <form>
  <input type="radio" id="Q4-4-1" name="Q4-4" value="Q4-4-1">
  <label for="Q4-4-1">Yes</label><br>
  <input type="radio" id="Q4-4-2" name="Q4-4" value="Q4-4-2">
  <label for="Q4-4-2">No</label><br>
  </form>
 <p>5.	Wax deposition occurs in a pipeline (select those applicable)</p>
 <form>
  <input type="radio" id="Q5-1" name="Q5-1" value="Q5-1">
  <label for="Q5-1">If the temperature of the fluid drops below the cloud point </label><br>
  <input type="radio" id="Q5-2" name="Q5-2" value="Q5-2">
  <label for="Q5-2">If the temperature of the wall is lower than the temperature of the core of the fluid</label><br>
  <input type="radio" id="Q5-3" name="Q5-3" value="Q5-3">
  <label for="Q5-3">When wax particles attach to the wall and gradually block the cross section over time  </label><br>
  </form>
<p>6.	Consider an oil export pipeline (50 km long, 0.254 m ID, uninsulated) that is transporting 15 000 Sm3/d of crude, with a density of 861 kg/m3 from the field to a refinery. The crude enters the export pipeline at a temperature of 50 C and quickly cools down to ambient temperature 25 C. </p> 

<p>a.	The crude has the following wax precipitation curve with temperature: wax content (in %) = -0.091 * T + 2.86.  The wax content in this equation is defined as the weight of (precipitated) wax particles divided by the weight of standard conditions (stock tank) oil.  </p> 
<p>b.	Assume that only 1% of the precipitated wax deposits on the wall. </p> 
<p>Using the wax precipitation curve, provide the WAT. Provide the number in C, without digits after the decimal point.Using the wax precipitation curve, provide the WAT. Provide the number in C, without digits after the decimal point.</p> 

<label for="Q6-1"> Answer: </label>
<input type="text" id="Q6-1" name="Q6-1">
<br>
<p>Consider that pigging should be performed when approximately 7000 kg of wax deposit on the pipe, How often should pigging be performed? Input the number in days, with one digit after the decimal point
</p>
<label for="Q6-2"> Answer: </label>
<input type="text" id="Q6-2" name="Q6-2">
<br>
 <p>A colleague has suggested that, to avoid having wax deposits and pigging the long pipeline, the company should build a storage tank in the field to cool down the fluid to 25 C and then pump the crude through the pipeline. He argues that the wax would then accumulate in the tank and then it is easier to remove wax there, and it will be needed to perform pigging less frequently, or not at all in the pipeline. Is his reasoning valid?</p>
 <form>
  <input type="radio" id="Q6-3-1" name="Q6-3" value="Q6-3-1">
  <label for="Q6-3-1">Yes</label><br>
  <input type="radio" id="Q6-3-2" name="Q6-3" value="Q6-3-2">
  <label for="Q6-3-2">No</label><br>
  </form>
 <p>7.	Corrosion is usually addressed by one of the following methods (select those applicable):</p>
 <form>
  <input type="radio" id="Q7-1" name="Q7-1" value="Q7-1">
  <label for="Q7-1">Protect the metal with a layer of non-reacting oxide</label><br>
  <input type="radio" id="Q7-2" name="Q7-2" value="Q7-2">
  <label for="Q7-2">Inhibitors</label><br>
  <input type="radio" id="Q7-3" name="Q7-3" value="Q7-3">
  <label for="Q7-3">Use corrosion resistant alloys</label><br>
  <input type="radio" id="Q7-4" name="Q7-4" value="Q7-4">
  <label for="Q7-4">Separate water</label><br>
  </form>
    <span>  </span>
    <p>Once ready submit here your results: </p>
    <input 
        id="submitBtn" 
        type="submit" 
        value="Submit" 
        onclick="sendData()" />
    <p>Submission message </p>  
     <div id="result">
      <em> Your result will appear here!</em>
    </div>
 <script>
       /**
         * Send number to Google Apps Script and returns a calculated 
         * value back to display on page. 
         */
      function sendData() {
        //Get inputted number and result div
        let ans1 =[ document.querySelector('#Q1').value]
        let ans2 =[ document.querySelector('#Q2').value]
        let ans3 =[ document.querySelector('#Q3').value]
        var ans4_1=convertMultChoic2Array("Q4-1");
        var ans4_2=convertMultChoic2Array("Q4-2");
        var ans4_3=convertMultChoic2Array("Q4-3");
        var ans4_4=convertMultChoic2Array("Q4-4");
        var ans5=[convertCheck2Integer('Q5-1'),convertCheck2Integer('Q5-2'),convertCheck2Integer('Q5-3')]
        let ans6_1 =[document.querySelector('#Q6-1').value];
        let ans6_2 =[document.querySelector('#Q6-2').value];
        let ans6_3 =convertMultChoic2Array("Q6-3");
        var ans7=[convertCheck2Integer('Q7-1'),convertCheck2Integer('Q7-2'),convertCheck2Integer('Q7-3'),convertCheck2Integer('Q7-4')]
        var ans_array = [ans1,ans2,ans3,ans4_1,ans4_2,ans4_3,ans4_4,ans5,ans6_1,ans6_2,ans6_3,ans7];
        let updateLocation = document.querySelector('#result');
        
        //If the Google Apps script fails this error will be displayed
        // under result. 
        // NOTE!!! not advisable for public deployment.
        function onFailure(error){
          let warning = `<span style="color:red">${error}</span>`;
          updateLocation.innerHTML = warning;
        };
        
        // The calculated result will be displayed in the result div.
        function onSuccess(element){
          let result = ` Message: ${element}`;
          updateLocation.innerHTML = result;
        };
        
        /** First tests if GAS code is successful,
          * attempts to run GAS-side function.
          * on failure sends to onFailure function with nature of error.
          * on success sends to onSuccess function with returned result.
          */
        var browser=get_browser_info();
        google.script.run.withFailureHandler(onFailure)
                         .withSuccessHandler(onSuccess)
                         .CheckAnswers(ans_array,browser);
 
      };
      function get_browser_info(){
    var ua=navigator.userAgent,tem,M=ua.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i) || []; 
    if(/trident/i.test(M[1])){
        tem=/\brv[ :]+(\d+)/g.exec(ua) || []; 
        return {name:'IE ',version:(tem[1]||'')};
        }   
    if(M[1]==='Chrome'){
        tem=ua.match(/\bOPR\/(\d+)/)
        if(tem!=null)   {return {name:'Opera', version:tem[1]};}
        }   
    M=M[2]? [M[1], M[2]]: [navigator.appName, navigator.appVersion, '-?'];
    if((tem=ua.match(/version\/(\d+)/i))!=null) {M.splice(1,1,tem[1]);}
    return {
      name: M[0],
      version: M[1]
    };
 }
 function convertMultChoic2Array(questionName) { 
            var ele = document.getElementsByName(questionName); 
            var a = [];  
            for(i = 0; i < ele.length; i++) { 
                if(ele[i].checked){a.push(1);}else{a.push(0);}   
            } 
        return a;
        } 
  function convertCheck2Integer(bulletName) { 
            var ele = document.getElementsByName(bulletName); 
            if(ele[0].checked){a=1;}else{a=0;}    
        return a;
        } 
    </script>
    
  </body>
</html>
